<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <title>Chapter 3 â€“ ë§¥ë¼ë Œ ì´ì ê³¼ ë¼ì´ë²Œì˜ íƒ„ìƒ</title>

  <!-- í°íŠ¸: Pretendard + Shadows Into Light -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link
    href="https://fonts.googleapis.com/css2?family=Pretendard:wght@300;400;500;600&family=Shadows+Into+Light&display=swap"
    rel="stylesheet"
  />

  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      background: #000;
      color: #fff;
      font-family: "Pretendard";
      overflow: hidden; /* í•œ í™”ë©´ ê³ ì • */
    }

    /* ìƒë‹¨ í—¤ë” (ì• ì±•í„°ë‘ í†¤ ë§ê²Œ) */
    header {
      width: 100%;
      padding: 18px 0;
      text-align: center;
      background: rgba(0, 0, 0, 0.9);
      font-size: 18px;
      font-weight: 500;
    }

    main {
      width: 100%;
      height: calc(100vh - 60px); /* í—¤ë” ì œì™¸ í™”ë©´ */
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      position: relative;
      overflow: hidden;
    }
    .nav {
        position: fixed;
        bottom: 20px;
        width: 100%;
        display: flex;
        justify-content: center;
        gap: 50px;
        z-index: 20;
    }

    .nav img {
        width: 120px;
        cursor: pointer;
    }
    .nav-btns {
      position: fixed;
      bottom: 0;         /* ğŸ“Œ í™”ë©´ ë°”ë‹¥ì— ë¶™ì„ */
      left: 0;
      width: 100%;       /* í™”ë©´ ì „ì²´ í­ ì‚¬ìš© */
      display: flex;
      justify-content: space-between; /* back = ì™¼ìª½ / forward = ì˜¤ë¥¸ìª½ */
      align-items: flex-end;
      padding: 0 30px 20px; /* ì¢Œìš° 30px, ì•„ë˜ 20px ì—¬ë°± */
      z-index: 9999;     /* ğŸ“Œ ìµœìƒë‹¨ ìš”ì†Œ */
      pointer-events: none; /* ê¸°ë³¸ í´ë¦­ ë§‰ê¸° */
    }

    /* ê°œë³„ ë²„íŠ¼ë§Œ í´ë¦­ ê°€ëŠ¥í•˜ê²Œ */
    .nav-btns a {
      pointer-events: all;
      display: block;
    }

    /* ë²„íŠ¼ í¬ê¸° ì¡°ì ˆ */
    .nav-btns img {
      height: 50px;  /* ì´ë¯¸ì§€ í¬ê¸° ì¡°ì ˆ */
      opacity: 0.9;
      transition: transform .2s, opacity .2s ease;
    }

    /* hover íš¨ê³¼ */
    .nav-btns img:hover {
      transform: scale(1.08);
      opacity: 1;
    }

    /* â”€â”€â”€â”€â”€ ë°°ê²½ ì‚¬ì§„ ì˜ì—­ â”€â”€â”€â”€â”€ */
    .mclaren-scene {
      position: relative;
      width: 100%;
      height: calc(100vh - 60px);
      background-image: url("ch3_rivary.png"); /* ğŸ‘‰ ë„ˆì˜ íŒŒì¼ëª…ìœ¼ë¡œ ìˆ˜ì • */
      background-size: cover;
      background-position: center;
      background-repeat: no-repeat;
    }

    .mclaren-scene img.bg-photo {
      width: 100%;
      height: auto;
      display: block;
    }

    /* 1988 world drivers' champion winner ë©”ëª¨ */
    .champion-note {
      position: absolute;
      left: 11%;
      top: 20%;
      font-family: "Shadows Into Light", cursive;
      font-size: 32px;
      line-height: 1.3;
      white-space: pre-line;
    }

    /* ê²€ì€ ë°•ìŠ¤ ê³µí†µ */
    .info-box {
      position: absolute;
      left: 4%;
      background: rgba(0, 0, 0, 0.9);
      padding: 18px 26px;
      max-width: 420px;
      font-size: 20px;
      line-height: 1.6;
        
      opacity: 0;
      transform: translateY(10px);
      transition: opacity 0.4s ease-out, transform 0.4s ease-out;
    }

    .info-box strong {
      display: block;
      font-size: 16px;
      margin-bottom: 6px;
    }

    .info-box.top {
      top: 42%;
    }

    .info-box.bottom {
      top: 62%;
    }
    /* ê¸°ì¡´ 1ë²ˆì§¸ ì¥ë©´ì„ ìœ„ë¡œ ì‚´ì§ ë°€ê¸° ìœ„í•œ íŠ¸ëœì§€ì…˜ */
    .mclaren-scene {
      position: relative; /* ì´ë¯¸ ìˆì„ ìˆ˜ë„ ìˆëŠ”ë° ìˆìœ¼ë©´ ì¤‘ë³µ X */
      transition: transform 0.9s cubic-bezier(0.19, 1, 0.22, 1),
                  filter 0.9s cubic-bezier(0.19, 1, 0.22, 1);
      z-index: 1;
    }

    /* íƒ€ì´í•‘ ëë‚˜ë©´ ì ìš©í•  ìƒíƒœ */
    .mclaren-scene.slide-up {
      transform: translateY(-12%);   /* ì‚´ì§ ìœ„ë¡œ ë°€ê¸° */
      filter: brightness(0.8);
      transition-delay: 1s       /* ì¡°ê¸ˆ ì–´ë‘¡ê²Œ */
    }

    /* RIVALRY ì˜¤ë²„ë© ì¥ë©´ */
    .rivalry-scene {
      position: absolute;
      inset: 0;
      background-image: url("ch3_rivary2.png");  /* ğŸ‘‰ ë‘ ë²ˆì§¸ ì´ë¯¸ì§€ íŒŒì¼ ì´ë¦„ */
      background-size: cover;
      background-position: center;
      background-repeat: no-repeat;
      transform: translateY(100%);   /* ì²˜ìŒì—” í™”ë©´ ì•„ë˜ì— ìˆ¨ê²¨ë‘  */
      transition: transform 1.5s cubic-bezier(0.19, 1, 0.22, 1);
      z-index: 2;
      transition-delay: 1s
    }

    /* ìœ„ë¡œ ìŠ¬ë¼ì´ë“œ ì¸ë  ë•Œ ìƒíƒœ */
    .rivalry-scene.show {
      transform: translateY(0);
    }

    .rivalry-card {
      position: absolute;
      left: 50%;
      top: 50%;
      transform: translate(-50%, -50%);
      background: rgba(0, 0, 0, 0.9);
      padding: 20px 40px;
      max-width: 520px;
      text-align: center;
      line-height: 1.6;
      font-size: 18px;
    }

    .rivalry-card strong {
      display: block;
      margin-bottom: 8px;
      font-size: 20px;
    }

    .play-video-btn {
      position: absolute;
      left: 50%;
      top: 130%;
      transform: translate(-50%, -50%);
      border: none;
      background: none;
      padding: 0;
      cursor: pointer;
      z-index: 10;
    }

    .play-video-btn img {
      display: block;
      width: 220px;       /* í•„ìš”í•˜ë©´ í¬ê¸° ì¡°ì ˆ */
      height: auto;
      filter: drop-shadow(0 0 12px rgba(0,0,0,0.6));
      transition: transform 0.2s ease, filter 0.2s ease;
    }

    .play-video-btn:hover img {
      transform: translateY(-2px) scale(1.03);
      filter: drop-shadow(0 0 20px rgba(0,0,0,0.8));
    }

    .video-overlay {
      position: fixed;
      inset: 0;
      background: rgba(0, 0, 0, 0.8);   /* ë’¤ì— ê¹ŒëŠ” ë°˜íˆ¬ëª… ë¸”ë™ */
      display: flex;
      align-items: center;
      justify-content: center;
      opacity: 0;
      pointer-events: none;
      z-index: 9999;
      transition: opacity 0.3s ease;
      flex-direction: column;
      opacity: 0;
    }

    .video-overlay.visible {
      opacity: 1;
      pointer-events: all;
    }

    .video-inner {
      position: relative;
      max-width: 900px;
      width: 80vw;
      box-shadow: 0 20px 60px rgba(0,0,0,0.7);
    }

    .video-inner video {
      width: 100%;
      height: auto;
      display: block;
      background: #000;
    }

    .video-close {
      position: absolute;
      top: -42px;
      right: -2px;
      background: none;
      border: none;
      color: white;
      font-size: 32px !important;
      cursor: pointer;
      z-index: 9999;
      opacity: 0.8;
      transition: opacity .2s ease, transform .2s ease;
    }

    .chapter-nav {
      position: fixed;
      bottom: 12px;
      left: 50%;
      transform: translateX(-50%);
      display: flex;
      gap: 40px;
      z-index: 30;
    }

    .nav-btn {
      cursor: pointer;
      transition: transform 0.2s ease, opacity 0.2s ease;
    }

    .nav-btn img {
      display: block;
      height: 40px;
      width: auto;
    }

    .nav-btn:hover {
      transform: translateY(-3px);
      opacity: 0.85;
    }
    /* ì²˜ìŒ í™”ë©´ì€ ì–´ë‘¡ê²Œ */
    .spotlight-overlay {
      position: fixed;
      inset: 0;
      background: black;
      pointer-events: none;
      z-index: 9999;
      transition: opacity 0.2s linear, background 0.05s linear; /* ğŸ‘ˆ opacityë„ ë¶€ë“œëŸ½ê²Œ */
      opacity: 1; /* ì²˜ìŒì—” ì™„ì „ ì–´ë‘ì›€ */
    }

    /* ë‹¤ ë°ì•„ì§„ ë’¤ ìƒíƒœ */
    .spotlight-overlay.fully-revealed {
      opacity: 0;
    }
    /* â–¶ ë¹„ë””ì˜¤ ì˜¤ë²„ë ˆì´ í•˜ë‹¨ next ë²„íŠ¼ ì˜ì—­ */
    .video-footer {
      margin-top: 18px;
      display: flex;
      justify-content: center;
    }

    .btn-next-scene {
      border: none;
      background: none;
      padding: 0;
      cursor: pointer;
    }

    .btn-next-scene img {
      display: block;
      width: 220px;   /* í•„ìš”í•˜ë©´ í¬ê¸° ì¡°ì ˆ */
    }

    /* â–¶ ë§ˆì§€ë§‰ ìŠ¤ì¦ˆì¹´ ì¥ë©´ ì˜¤ë²„ë ˆì´ */
    .final-scene-overlay {
      position: fixed;
      inset: 0;
      display: none;                 /* ê¸°ë³¸ì€ ìˆ¨ê¹€ */
      align-items: center;
      justify-content: center;
      z-index: 1300;
      background: rgba(0, 0, 0, 0.85);
    }

    .final-scene-overlay.visible {
      display: flex;
    }

    .final-scene {
      position: relative;
      width: 100%;
      height: 100%;
      background-image: url("ch3_last_scene.png"); /* ë°°ê²½ ì´ë¯¸ì§€ */
      background-size: cover;
      background-position: center;
    }

    /* ì˜¤ë¥¸ìª½ ì•„ë˜ ì„¤ëª… ì¹´ë“œ */
    .final-info-card {
      position: absolute;
      right: 5%;
      bottom: 8%;
      max-width: 420px;
      background: rgba(240, 238, 232, 0.95);
      color: #222;
      padding: 18px 24px;
      font-size: 14px;
      line-height: 1.6;
    }

    /* ì™¼ìª½ ìœ„ ì„œí‚· ê°€ì´ë“œ ì¢…ì´ (í•„ìš” ì—†ìœ¼ë©´ ì‚­ì œí•´ë„ ë¨) */
    .final-map {
      position: absolute;
      left: 5%;
      top: 10%;
      width: 220px;
      transform: rotate(-5deg);
    }

   
  </style>
</head>
<body>
  <audio id="bgm" src="ch3_bgm.mp3" loop></audio>
  <audio id="typingSfx" src="ch3_typing.mp3"></audio>
  <header>
    ë§¥ë¼ë Œ ì´ì ê³¼ 'ì „ì„¤ì ì¸ ë¼ì´ë²Œ'ì˜ íƒ„ìƒ (1988ë…„ ~ 1989ë…„)
  </header>
  <div class="spotlight-overlay"></div>

  <main>
    <section class="mclaren-scene">
      <!-- ğŸ‘‰ ì—¬ê¸° íŒŒì¼ ì´ë¦„ì„ ë„¤ê°€ ì €ì¥í•œ ì´ë¯¸ì§€ ì´ë¦„ìœ¼ë¡œ ë°”ê¿”ì¤˜ -->

      <!-- ì†ê¸€ì”¨ í…ìŠ¤íŠ¸ -->
      <div class="champion-note">
      1988 world drivers'
      champion winner
      </div>

      <!-- ìƒë‹¨ info ë°•ìŠ¤ -->
      <div class="info-box top">
        <strong>ë“œë¦¼íŒ€ ê²°ì„± (1988ë…„)</strong>
        <span id="infoTopText"></span>
      </div>

      <div class="info-box bottom">
        <strong>ì²« ì±”í”¼ì–¸ (1988ë…„)</strong>
        <span id="infoBottomText"></span>
      </div>
    </section>
    <section class="rivalry-scene">
      <div class="rivalry-card">
        <strong>ìˆ™ëª…ì˜ ëŒ€ê²° (1989ë…„)</strong>
        í•˜ì§€ë§Œ ë¼ì´ë²Œ ê´€ê³„ëŠ” ê·¹ì— ë‹¬í–ˆê³ , ì±”í”¼ì–¸ì‹­ì„ ë‘ê³ <br>ì¼ë³¸ ìŠ¤ì¦ˆì¹´ ì„œí‚·ì—ì„œ ì—´ë¦°
        ê²°ì •ì ì¸ ë ˆì´ìŠ¤ì—ì„œ<br>ë‘ ì„ ìˆ˜ëŠ” ì¶©ëŒ ì‚¬ê³ ë¥¼ ì¼ìœ¼í‚¤ë©° ì—­ì‚¬ì ì¸ ì¥ë©´ì„ ë‚¨ê²¼ë‹¤.
        <button id="playVideoBtn" class="play-video-btn">
        <img src="ch3_play_video.png" alt="play video">
      </button>
      </div>
      <!-- ğŸ¬ ë¹„ë””ì˜¤ ì˜¤ë²„ë ˆì´ -->
    <div id="videoOverlay" class="video-overlay">
      <div class="video-inner">
        <button class="video-close">&times;</button>
        <video id="rivalryVideo" src="ch3_suzuka.mp4" controls></video>
      </div>
          <!-- â–¶ ë¹„ë””ì˜¤ ì•„ë˜ next ë²„íŠ¼ -->
      <div class="video-footer">
      <button class="btn-next-scene">
        <img src="ch3_btn_next.png" alt="next">
      </button>
    </div>
    </div>

    </section>

    <!-- â–¶ ë§ˆì§€ë§‰ ìŠ¤ì¦ˆì¹´ ì¥ë©´ ì˜¤ë²„ë ˆì´ -->
    <div class="final-scene-overlay" id="finalScene">
      <div class="final-scene">
      <img class="final-map" src="ch3_suzuka_map.png" alt="Suzuka map"> -->

        <div class="final-info-card">
          ê²°ë¡ ì ìœ¼ë¡œëŠ” ì„¸ë‚˜ê°€ ì‹¤ê²© ì²˜ë¦¬ë˜ë©´ì„œ í”„ë¡œìŠ¤íŠ¸ê°€ ì±”í”¼ì–¸ì„
          ì°¨ì§€í•˜ê²Œ ë˜ì—ˆê³ , ì´ ì‚¬ê±´ì€ F1 ì—­ì‚¬ìƒ ê°€ì¥ ë…¼ë€ì´ ë§ì€ ìˆœê°„
          ì¤‘ í•˜ë‚˜ë¡œ ê¸°ë¡ëœë‹¤.
        </div>
      </div>
    </div>

    <!-- back / forward ë²„íŠ¼ -->
    <div class="nav-btns">
      <a href="chapter2.html" class="btn-back">
        <img src="btn_back.png" alt="back">
      </a>
      <a href="chapter4.html" class="btn-forwards">
        <img src="btn_forward.png" alt="forward">
      </a>
    </div>
  </main>
  <script>
    /* ================================
       ê¸°ë³¸ ìš”ì†Œë“¤ ì„ íƒ
    ================================= */
    const mclarenScene = document.querySelector(".mclaren-scene");
    const rivalryScene = document.querySelector(".rivalry-scene");

    const spotlight = document.querySelector(".spotlight-overlay");

    const bgm = document.getElementById("bgm");
    const typingSfx = document.getElementById("typingSfx");

    const infoTopEl = document.getElementById("infoTopText");
    const infoBottomEl = document.getElementById("infoBottomText");

    bgm.volume = 0;

    /* ================================
       ìƒíƒœê°’
    ================================= */
    let revealProgress = 0;
    let typingStarted = false;
    let musicStarted = false;

    /* ================================
       í…ìŠ¤íŠ¸ ì›ë¬¸
    ================================= */
    const infoTopFull =
      "ë‹¹ëŒ€ ìµœê³ ì˜ íŒ€ì´ì—ˆë˜ ë§¥ë¼ë Œ(McLaren)ìœ¼ë¡œ ì´ì í•˜ì—¬ ì•Œë­ í”„ë¡œìŠ¤íŠ¸ì™€ ë“€ì˜¤ë¥¼ ë§ºì—ˆë‹¤.";
    const infoBottomFull =
      "ì„¸ë‚˜ëŠ” í”„ë¡œìŠ¤íŠ¸ì™€ì˜ ì¹˜ì—´í•œ ê²½ìŸ ëì— 8ìŠ¹ì„ ê±°ë‘ë©° ìƒì•  ì²« ë“œë¼ì´ë²„ ì±”í”¼ì–¸ì‹­ ìš°ìŠ¹ì„ ì°¨ì§€";

    /* ================================
       ğŸµ BGM í˜ì´ë“œ ì¸/ì•„ì›ƒ
    ================================= */
    function fadeInMusic(duration = 5000) {
      const stepTime = 80;
      const steps = duration / stepTime;
      const volumeStep = 1 / steps;

      let currentVolume = 0;
      bgm.play().catch(() => {});

      const fade = setInterval(() => {
        currentVolume += volumeStep;
        if (currentVolume >= 1) {
          currentVolume = 1;
          clearInterval(fade);
        }
        bgm.volume = currentVolume;
      }, stepTime);
    }

    function fadeOutMusic(duration = 2000) {
      const stepTime = 80;
      const steps = duration / stepTime;
      const volumeStep = bgm.volume / steps;

      const fade = setInterval(() => {
        let v = bgm.volume - volumeStep;
        if (v <= 0) {
          bgm.volume = 0;
          bgm.pause();
          clearInterval(fade);
        } else {
          bgm.volume = v;
        }
      }, stepTime);
    }

    /* ================================
       âœï¸ íƒ€ì´í•‘ + íš¨ê³¼ìŒ
    ================================= */
    function startTypingSound() {
      typingSfx.currentTime = 0;
      typingSfx.volume = 0.35;
      typingSfx.loop = true;
      typingSfx.play().catch(() => {});
    }

    function stopTypingSound() {
      typingSfx.pause();
      typingSfx.currentTime = 0;
    }

    function typeText(element, fullText, speed, onComplete) {
      element.textContent = "";
      let i = 0;

      const typing = setInterval(() => {
        element.textContent += fullText.charAt(i);
        i++;
        if (i >= fullText.length) {
          clearInterval(typing);
          if (onComplete) onComplete();
        }
      }, speed);
    }

    /* ================================
       âœï¸ ë‘ ì¤„ íƒ€ì´í•‘ ì§„í–‰
    ================================= */
    function startTypingSequence() {
      if (typingStarted) return;
      typingStarted = true;

      const topBox = document.querySelector(".info-box.top");
      const bottomBox = document.querySelector(".info-box.bottom");

      topBox.style.opacity = 1;
      topBox.style.transform = "translateY(0)";

      startTypingSound();

      typeText(infoTopEl, infoTopFull, 180, () => {
        setTimeout(() => {
          bottomBox.style.opacity = 1;
          bottomBox.style.transform = "translateY(0)";

          typeText(infoBottomEl, infoBottomFull, 180, () => {
            stopTypingSound();

            mclarenScene.classList.add("slide-up");
            rivalryScene.classList.add("show");
          });
        }, 350);
      });
    }

    /* ================================
       ğŸ”¦ spotlight ë°ì•„ì§€ê¸° íš¨ê³¼
    ================================= */
    document.addEventListener("mousemove", (e) => {
      const x = e.clientX;
      const y = e.clientY;

      spotlight.style.background = `
        radial-gradient(circle at ${x}px ${y}px,
          transparent 0%,
          transparent 8%,
          black 18%,
          black 100%)
      `;

      if (revealProgress < 1) {
        revealProgress += 0.004;
        spotlight.style.opacity = 1 - revealProgress;

        if (revealProgress >= 1) {
          spotlight.classList.add("fully-revealed");

          setTimeout(() => {
            spotlight.style.display = "none";
            fadeInMusic();         
            startTypingSequence();
          }, 320);
        }
      }
    });

    /* ================================
       ğŸ¬ ë¹„ë””ì˜¤ overlay ì œì–´
    ================================= */
    const playVideoBtn = document.getElementById("playVideoBtn");
    const videoOverlay = document.getElementById("videoOverlay");
    const rivalryVideo = document.getElementById("rivalryVideo");
    const videoCloseBtn = document.querySelector(".video-close");

    const nextBtn = document.querySelector(".btn-next-scene");
    const finalScene = document.getElementById("finalScene");
    const finalClose = document.querySelector(".final-close");

    /* â–¶ ë¹„ë””ì˜¤ ì¬ìƒ ë²„íŠ¼ */
    playVideoBtn.addEventListener("click", () => {
      fadeOutMusic(2000);

      setTimeout(() => {
        videoOverlay.classList.add("visible");
        rivalryVideo.currentTime = 0;
        rivalryVideo.play();
      }, 600);
    });

    /* â–¶ ë¹„ë””ì˜¤ ë‹«ê¸° ê³µí†µ í•¨ìˆ˜ */
    function closeVideo() {
      rivalryVideo.pause();
      rivalryVideo.currentTime = 0;
      videoOverlay.classList.remove("visible");
    }

    /* X ë²„íŠ¼ */
    videoCloseBtn.addEventListener("click", closeVideo);

    /* ì˜¤ë²„ë ˆì´ ë°°ê²½ í´ë¦­í•´ë„ ë‹«ê¸° */
    videoOverlay.addEventListener("click", (e) => {
      if (e.target === videoOverlay) closeVideo();
    });

    /* ================================
       â–¶ next ë²„íŠ¼ â†’ ë§ˆì§€ë§‰ ìŠ¤ì¦ˆì¹´ ì¥ë©´
    ================================= */
    nextBtn.addEventListener("click", () => {
      closeVideo();                  // ì˜ìƒ ë‹«ê¸°
      finalScene.classList.add("visible");  // ìŠ¤ì¦ˆì¹´ í™”ë©´ ì—´ê¸°
    });
   
    </script>
</body>
</html>